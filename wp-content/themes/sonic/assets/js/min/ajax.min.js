/*!
 * AJAX navigation methods
 *
 * Sonic 2.2.4
 */
var SonicUi=SonicUi||{},SonicAjaxNav=SonicAjaxNav||{},SonicParams=SonicParams||{},console=console||{};SonicAjaxNav=function(a){"use strict";return{body:a("body"),contentDiv:".site-content",$dom:null,currentUrl:window.location.href,init:function(){SonicParams.is404||(a("#ajax-progress-bar").length||a(".site-container").prepend('<div id="ajax-progress-bar"></div>'),a("#ajax-content").length||(a(this.contentDiv).wrapInner('<div id="ajax-content" />'),this.playVideos()),this.setAjaxLinkClass(),this.clickEvent(),this.browserNavigation(),this.updateCurrentUrl())},playVideos:function(){a(".video-bg, .wpb-video-bg").each(function(){a(this).get(0).play()})},untrailingSlashit:function(a){return a=a||"","/"===a.charAt(a.length-1)&&(a=a.substr(0,a.length-1)),a},setAjaxLinkClass:function(){var b,c=SonicParams.siteUrl,d="";a.each(SonicParams.allowedMimeTypes,function(a,b){d+="|"+b}),d=a.trim(d).substring(1),c=SonicParams.siteUrl,b=a("a[href^='"+c+"'], a[href^='/'], a[href^='./'], a[href^='../']"),b=b.not(function(){return a(this).attr("href").match(".("+d+")$")}),b.addClass("ajax-link"),SonicParams.isWooCommerce&&(this.untrailingSlashit(c)!==this.untrailingSlashit(SonicParams.WooCommerceCartUrl)&&a("a[href^='"+SonicParams.WooCommerceCartUrl+"']").removeClass("ajax-link"),this.untrailingSlashit(c)!==this.untrailingSlashit(SonicParams.WooCommerceAccountUrl)&&a("a[href^='"+SonicParams.WooCommerceAccountUrl+"']").removeClass("ajax-link"),this.untrailingSlashit(c)!==this.untrailingSlashit(SonicParams.WooCommerceCheckoutUrl)&&a("a[href^='"+SonicParams.WooCommerceCheckoutUrl+"']").removeClass("ajax-link"),a(".woocommerce-MyAccount-navigation a, .add_to_cart_button, .woocommerce-main-image, .product .images a, .product-remove a, .wc-proceed-to-checkout a, .wc-forward").removeClass("ajax-link")),a(".wpml-ls-item, .wpml-ls-item a").removeClass("ajax-link"),a("[class*='wp-image-']").parent().removeClass("ajax-link"),a(".no-ajax").removeClass("ajax-link"),a("#wpadminbar a").removeClass("ajax-link"),a(".lightbox, .wpb-lightbox, .video-item .entry-link, .last-photos-thumbnails, .scroll, .wpb-nav-scroll").removeClass("ajax-link"),a(".widget_meta a, a.logo-link, a.comment-reply-link, a#cancel-comment-reply-link, a.post-edit-link, a.comment-edit-link, a.share-link, .single .comments-link a").removeClass("ajax-link"),a("#blog-filter a, #albums-filter a, #videos-filter a, #plugin-filter a, .logged-in-as a, #trigger a").removeClass("ajax-link"),a(".is-infinitescroll .nav-links a, .envato-item-presentation a").removeClass("ajax-link"),a(".dropdown li.menu-item-has-children > a, .dropdown li.page_item_has_children > a").removeClass("ajax-link")},browserNavigation:function(){var b,c=this;window.userInteractionTimeout=null,window.userInteractionInHTMLArea=!1,window.onBrowserHistoryButtonClicked=null,a(document).mousedown(function(){clearTimeout(window.userInteractionTimeout),window.userInteractionInHTMLArea=!0,window.userInteractionTimeout=setTimeout(function(){window.userInteractionInHTMLArea=!1},500)}),a(document).keydown(function(){clearTimeout(window.userInteractionTimeout),window.userInteractionInHTMLArea=!0,window.userInteractionTimeout=setTimeout(function(){window.userInteractionInHTMLArea=!1},500)}),window.history&&window.history.pushState&&a(window).on("popstate",function(d){window.userInteractionInHTMLArea||(b=location.href,c.removeHash(c.currentUrl)===c.removeHash(b)||c.navigate(b,"no"),a(window).trigger("wolf_on_browser_navigation"))})},goToAnchor:function(b){var c,d=0,e=SonicUi.getToolBarOffset()+SonicUi.getMenuOffsetFromTheme()-5;-1!==b.indexOf("#")&&(c=b.substring(b.indexOf("#")+1),a("#"+c).length&&(d=a("#"+c).offset().top-e,0>d&&(d=1)))},updateCurrentUrl:function(){var b,c=this;a(window).on("hashchange",function(a){b=window.location.hash,c.currentUrl=window.location.href})},removeHash:function(a){if(-1!==a.indexOf("#")){var b=a.substring(a.indexOf("#"));""!==b&&(a=a.replace(b,""))}return a},navigate:function(b,c){var d,e,f,g,h,i,j=this,c=c||"yes",k=a("body"),l="menu-toggle";a("#navbar-mobile-container");h=window.location.href,d=b.replace(b,SonicParams.siteUrl),i=parseInt(80*Math.random()+8),a("#ajax-progress-bar").show().animate({width:i+"%"}),a("html").addClass("ajax-loading"),k.removeClass(l),a("ul.sub-menu.menu-item-open").slideUp().removeClass("menu-item-open"),a.ajax({type:"POST",dataType:"html",url:SonicParams.ajaxUrl,data:{url:b,action:"sonic_ajax_get_page_markup",nonce:g},xhr:function(){return e=new window.XMLHttpRequest,e.addEventListener("progress",function(b){b.lengthComputable?(f=Math.round(b.loaded/b.total*100),i<f&&a("#ajax-progress-bar").css({width:f+"%"})):console.log("Progress no reported")},!1),e},error:function(){console.log("unkown error"),j.currentUrl=b,window.location.replace(b)},beforeSend:function(){},complete:function(){},success:function(d){"error"===d?(j.currentUrl=b,window.location.replace(b)):(j.$dom=a(document.createElement("html")),j.$dom[0].innerHTML=d,j.process(b),"yes"===c&&h!==b&&window.history.pushState(null,null,b),j.trackPageView(b),j.currentUrl=b,a(window).trigger("wolf_after_ajax_load"))}})},clickEvent:function(){var b,c,d,e=this;a(document).on("click",".ajax-link",function(f){f.preventDefault(),f.stopPropagation(),b=a(this),d=window.location.href,c=b.attr("href"),d!==c&&(b.hasClass("menu-link")&&(a(".menu-item").removeClass("menu-link-active current_page_item current-menu-parent current-menu-item"),b.parents(".menu-parent-item").length?b.parents(".menu-parent-item").addClass("menu-link-active"):b.parent("li").addClass("menu-link-active")),e.navigate(c))})},trackPageView:function(a){var b=this.$dom.find("title").html();"undefined"!=typeof _gaq?_gaq.push(["_trackPageview",a]):"undefined"!=typeof ga&&ga("send","pageview",{page:a,title:b})},loadTitle:function(){var b=this.$dom.find("title");a("title").html(b.html())},loadCustomPostStyle:function(){var b=this.$dom.find("style#sonic-single-post-style-inline-css");a("style#sonic-single-post-style-inline-css").html(b.html())},process:function(b){var c,d=this.$dom.find(this.contentDiv).html(),e=this.$dom.find("body"),f=(this.$dom.find("title"),e.attr("class")),g=0,h=0;a(window).scrollTop(0),"undefined"!=typeof WPBCountdown&&WPBCountdown.destroy(),a("#ajax-content").empty().html(d),this.setBodyClasses(f),this.loadCustomPostStyle(),this.loadTitle(),this.removeParallaxMirrors(),this.updateAdminbar(),this.updateWPMLInMenu(),this.callBack(),-1!==b.indexOf("#")&&(c=b.substring(b.indexOf("#")+1),""!==c&&(g=SonicUi.getToolBarOffset()+SonicUi.getMenuOffsetFromTheme()-5,h=a("#"+c).offset().top-g)),a(window).scrollTop(h),a("#ajax-progress-bar").css({width:"100%"}),setTimeout(function(){a(window).trigger("resize"),a("html").removeClass("ajax-loading"),a("#ajax-progress-bar").hide().css({width:"0%"})},500)},removeParallaxMirrors:function(){a(".parallax-mirror").remove()},setBodyClasses:function(b){b=b.replace("loading",""),b+=" loaded",SonicParams.isUserLoggedIn&&(b+=" logged-in admin-bar loaded"),a("body").attr("class","").addClass(b)},updateAdminbar:function(){var b=this.$dom.find("#wpadminbar");a("#wpadminbar").html(b.html())},updateWPMLInMenu:function(){var b,c=[];this.$dom.find("#navbar-container .custom-wpml-iso-codes")&&(b=this.$dom.find("#navbar-container .custom-wpml-iso-codes"),a("#navbar-container .custom-wpml-iso-codes").html(b.html())),this.$dom.find("#navbar-container .wpml-ls-menu-item").length&&this.$dom.find("#navbar-container .wpml-ls-menu-item").each(function(){c.push(a(this).html())}),a("#site-navigation-primary-desktop .wpml-ls-menu-item").each(function(b){"undefined"!=typeof c[b]&&a(this).html(c[b])}),a("#site-navigation-primary-mobile .wpml-ls-menu-item").each(function(b){"undefined"!=typeof c[b]&&a(this).html(c[b])}),a("#site-navigation-tertiary .wpml-ls-menu-item").each(function(b){"undefined"!=typeof c[b]&&a(this).html(c[b])})},callBack:function(){this.themeCallback(),this.WooCommerceCallback(),this.WPBCallback(),this.wolfPluginsCallback(),this.thirdPartyCallback(),this.setAjaxLinkClass()},themeCallback:function(){"undefined"!=typeof SonicUi&&(SonicUi.init(),SonicUi.postBg(),SonicUi.singlePostNavBg(),SonicUi.fluidVideos(),SonicUi.youtubeWmode(),SonicUi.setVimeoOptions(),SonicUi.likes(),SonicUi.lightbox(),SonicUi.flexSlider(),SonicUi.owlCarousel(),SonicUi.parallax(),SonicUi.postPaddingTop(),SonicUi.animateAnchorLinks(),SonicUi.shareLinkPopup(),SonicUi.lazyLoad(),SonicUi.additionalFixes()),"undefined"!=typeof SonicYTVideoBg&&SonicYTVideoBg.playVideo(),"undefined"!=typeof SonicMasonry&&SonicMasonry.init(),"undefined"!=typeof SonicCategoryFilter&&SonicCategoryFilter.init(),"undefined"!=typeof SonicInfiniteScroll&&SonicInfiniteScroll.init(),"undefined"!=typeof SonicPhotos&&SonicPhotos.init(),a("#ajax-content").find(".twitter-tweet").length&&a.getScript("http://platform.twitter.com/widgets.js"),a("#ajax-content").find(".instagram-media").length&&(a.getScript("//platform.instagram.com/en_US/embeds.js"),"undefined"!=typeof window.instgrm&&window.instgrm.Embeds.process()),a("#ajax-content").find(".fb-page").length&&FB.XFBML.parse(),a("#ajax-content").find("audio.wp-audio-shortcode, video.wp-video-shortcode").length&&a("#ajax-content").find("audio.wp-audio-shortcode, video.wp-video-shortcode").mediaelementplayer()},WooCommerceCallback:function(){a("body").hasClass("single-product")&&a(".wc-tabs-wrapper, .woocommerce-tabs, #rating").trigger("init"),a(".woocommerce-ordering").length&&a(".woocommerce-ordering").on("change","select.orderby",function(){a(this).closest("form").submit()}),a("input.qty").length&&a("input.qty:not(.product-quantity input.qty)").each(function(){var b=parseFloat(a(this).attr("min"));b>=0&&parseFloat(a(this).val())<b&&a(this).val(b)}),this.WooCommercePriceFilter()},WooCommercePriceFilter:function(){if("undefined"==typeof woocommerce_price_slider_params||1>a(".price_slider").length)return!1;a("input#min_price, input#max_price").hide(),a(".price_slider, .price_label").show();var b=a(".price_slider_amount #min_price").data("min"),c=a(".price_slider_amount #max_price").data("max"),d=parseInt(b,10),e=parseInt(c,10);woocommerce_price_slider_params.min_price&&(d=parseInt(woocommerce_price_slider_params.min_price,10)),woocommerce_price_slider_params.max_price&&(e=parseInt(woocommerce_price_slider_params.max_price,10)),a(document.body).bind("price_slider_create price_slider_slide",function(b,c,d){"left"===woocommerce_price_slider_params.currency_pos?(a(".price_slider_amount span.from").html(woocommerce_price_slider_params.currency_symbol+c),a(".price_slider_amount span.to").html(woocommerce_price_slider_params.currency_symbol+d)):"left_space"===woocommerce_price_slider_params.currency_pos?(a(".price_slider_amount span.from").html(woocommerce_price_slider_params.currency_symbol+" "+c),a(".price_slider_amount span.to").html(woocommerce_price_slider_params.currency_symbol+" "+d)):"right"===woocommerce_price_slider_params.currency_pos?(a(".price_slider_amount span.from").html(c+woocommerce_price_slider_params.currency_symbol),a(".price_slider_amount span.to").html(d+woocommerce_price_slider_params.currency_symbol)):"right_space"===woocommerce_price_slider_params.currency_pos&&(a(".price_slider_amount span.from").html(c+" "+woocommerce_price_slider_params.currency_symbol),a(".price_slider_amount span.to").html(d+" "+woocommerce_price_slider_params.currency_symbol)),a(document.body).trigger("price_slider_updated",[c,d])}),a(".price_slider").slider({range:!0,animate:!0,min:b,max:c,values:[d,e],create:function(){a(".price_slider_amount #min_price").val(d),a(".price_slider_amount #max_price").val(e),a(document.body).trigger("price_slider_create",[d,e])},slide:function(b,c){a("input#min_price").val(c.values[0]),a("input#max_price").val(c.values[1]),a(document.body).trigger("price_slider_slide",[c.values[0],c.values[1]])},change:function(b,c){a(document.body).trigger("price_slider_change",[c.values[0],c.values[1]])}})},wolfPluginsCallback:function(){"undefined"!=typeof WPM&&WPM.init(),"undefined"!=typeof WolfAlbums&&WolfAlbums.init(),"undefined"!=typeof WolfVideos&&WolfVideos.init(),"undefined"!=typeof WolfGram&&WolfGram.init(),"undefined"!=typeof WolfPlugins&&WolfPlugins.init(),"undefined"!=typeof WolfWooCommerceWishlist&&WolfWooCommerceWishlist.init()},WPBCallback:function(){"undefined"!=typeof WPB&&WPB.ajaxCallback()},thirdPartyCallback:function(){a.isFunction(a.wpcf7InitForm)&&a("div.wpcf7 > form").wpcf7InitForm()}}}(jQuery),function(a){"use strict";a(document).ready(function(){SonicAjaxNav.init()})}(jQuery);